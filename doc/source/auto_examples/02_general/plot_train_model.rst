

.. _sphx_glr_auto_examples_02_general_plot_train_model.py:



.. _enc1:

=========================================
 Load dataset and train model
=========================================

An example of dataset.Dataset and model.Model.



Start with the necessary imports
--------------------------------



.. code-block:: python

    from os.path import join

    from gclda.dataset import Dataset
    from gclda.model import Model
    from gclda.utils import get_resource_path







Initialize dataset
----------------------------------



.. code-block:: python

    dataset_label = 'Neurosynth2015Filtered2_1000docs'
    dataset_dir = join(get_resource_path(), 'datasets')
    dataset = Dataset(dataset_label, dataset_dir)
    dataset.display_dataset_summary()





.. rst-class:: sphx-glr-script-out

 Out::

    --- Dataset Summary ---
             Dataset Label   = 'Neurosynth2015Filtered2_1000docs'
             Word-Tokens     = 40874
             Peak-Tokens     = 34213
             Word-Types      = 6755
             Documents       = 1000
             Peak-Dimensions = 3


Initialize model
----------------------



.. code-block:: python

    model = Model(dataset, n_topics=200, n_regions=2,
                  alpha=.1, beta=.01, gamma=.01, delta=1.0,
                  dobs=25, roi_size=50, symmetric=True,
                  seed_init=1)
    model.display_model_summary()





.. rst-class:: sphx-glr-script-out

 Out::

    Constructing/Initializing GC-LDA Model
    --- Model Summary ---
     Current State:
             Current Iteration   = 0
             Initialization Seed = 1
             Current Log-Likely  = -887284.070529
     Model Hyper-Parameters:
             Symmetric = True
             n_topics  = 200
             n_regions = 2
             alpha     = 0.100
             beta      = 0.010
             gamma     = 0.010
             delta     = 1.000
             roi_size  = 50.000
             dobs      = 25
     Model Training-Data Information:
             Dataset Label                 = Neurosynth2015Filtered2_1000docs
             Word-Tokens (n_word_tokens)   = 40874
             Peak-Tokens (n_peak_tokens)   = 34213
             Word-Types (n_word_labels)    = 6755
             Documents (n_docs)            = 1000
             Peak-Dimensions (n_peak_dims) = 3


Run model (10 iterations)
-------------------------



.. code-block:: python

    n_iterations = 10
    for i in range(model.iter, n_iterations):
        model.run_complete_iteration(loglikely_freq=10, verbose=1)
    model.display_model_summary()




.. rst-class:: sphx-glr-script-out

 Out::

    Iter 0010 Log-likely: x =  -491920.2, w =  -395537.1, tot =  -887457.3
    --- Model Summary ---
     Current State:
             Current Iteration   = 10
             Initialization Seed = 1
             Current Log-Likely  = -887457.324857
     Model Hyper-Parameters:
             Symmetric = True
             n_topics  = 200
             n_regions = 2
             alpha     = 0.100
             beta      = 0.010
             gamma     = 0.010
             delta     = 1.000
             roi_size  = 50.000
             dobs      = 25
     Model Training-Data Information:
             Dataset Label                 = Neurosynth2015Filtered2_1000docs
             Word-Tokens (n_word_tokens)   = 40874
             Peak-Tokens (n_peak_tokens)   = 34213
             Word-Types (n_word_labels)    = 6755
             Documents (n_docs)            = 1000
             Peak-Dimensions (n_peak_dims) = 3


**Total running time of the script:** ( 1 minutes  48.308 seconds)



.. only :: html

 .. container:: sphx-glr-footer


  .. container:: sphx-glr-download

     :download:`Download Python source code: plot_train_model.py <plot_train_model.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: plot_train_model.ipynb <plot_train_model.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
